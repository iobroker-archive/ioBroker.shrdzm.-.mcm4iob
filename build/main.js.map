{
  "version": 3,
  "sources": ["../src/main.ts"],
  "sourcesContent": ["/*\n * Created with @iobroker/create-adapter v2.6.5\n */\n\nimport * as utils from '@iobroker/adapter-core';\nimport dgram, { type RemoteInfo } from 'node:dgram';\n\n\ntype ShrdzmMsg = {\n    id: string;\n    data: {\n        timestamp: string;\n        [key: string]: string;\n        uptime: string;\n    };\n};\n\ntype ShrzmDeviceId = string;\ntype ObisCode = string;\n\nconst OBIS: {\n    [key: ObisCode]: {\n        name: string;\n        role: string;\n        unit: string;\n    };\n} = {\n    '1.6.0': {\n        // Viertelstundenmaximum (Bezug) in kW\n        name: 'lblPeakActivePowerConsumed',\n        role: 'value.power.consumed',\n        unit: 'W',\n    },\n    '2.6.0': {\n        // Viertelstundenmaximum (Einspeisung) in kW\n        name: 'lblPeakActivePowerProduced',\n        role: 'value.power.produced',\n        unit: 'Wh',\n    },\n    '1.7.0': {\n        // Momentanleistung (Bezug) in kW\n        name: 'lblActivePowerConsumed',\n        role: 'value.power.consumed',\n        unit: 'W',\n    },\n    '2.7.0': {\n        // Momentanleistung (Einspeisung) in kW\n        name: 'lblActivePowerProduced',\n        role: 'value.power.produced',\n        unit: 'W',\n    },\n    '3.7.0': {\n        // Momentanblindleistung (Bezug) in kVar\n        name: 'lblReactivePowerConsumed',\n        role: 'value.power.reactive',\n        unit: 'Var',\n    },\n    '4.7.0': {\n        // Momentanblindleistung (Einspeisung) in kVar\n        name: 'lblReactivePowerProduced',\n        role: 'value.power.reactive',\n        unit: 'Var',\n    },\n    '1.8.0': {\n        // Summe Energie / Z\u00E4hlerstand (Bezug) in kWh\n        name: 'lblActiveEnergyConsumed',\n        role: 'value.energy.consumed',\n        unit: 'Wh',\n    },\n    '1.8.1': {\n        // Z\u00E4hlerstand (Bezug) T1 (NT) in kWh\n        name: 'lblActiveEnergyT1Consumed',\n        role: 'value.energy.consumed',\n        unit: 'Wh',\n    },\n    '1.8.2': {\n        // Z\u00E4hlerstand (Bezug) T2 (HT) in kWh\n        name: 'lblActiveEnergyT2Consumed',\n        role: 'value.energy.consumed',\n        unit: 'Wh',\n    },\n    '2.8.0': {\n        // Summe Energie Z\u00E4hlerstand (Einspeisung) in kWh\n        name: 'lblACtiveEnergyProduced',\n        role: 'value.energy.produced',\n        unit: 'Wh',\n    },\n    '2.8.1': {\n        // Z\u00E4hlerstand (Einspeisung) T1 (NT) in kWh\n        name: 'lblActiveEnergyT1Produced',\n        role: 'value.energy.produced',\n        unit: 'Wh',\n    },\n    '2.8.2': {\n        // Z\u00E4hlerstand (Einspeisung) T2 (HT) in kWh\n        name: 'lblActiveEnergyT2Produced',\n        role: 'value.energy.produced',\n        unit: 'Wh',\n    },\n    '3.8.0': {\n        // Summe Blindenergie (Bezug) in kVarh\n        name: 'lblReactiveEnergyConsumed',\n        role: 'value.energy.reactive',\n        unit: 'Var',\n    },\n    '4.8.0': {\n        // Summe Blindenergie (Einspeisung) in kVarh\n        name: 'lblReactiveEnergyProduced',\n        role: 'value.energy.reactive',\n        unit: 'Var',\n    },\n    '16.7.0': {\n        // Momentleistung (saldiert) in kW\n        name: 'lblPower',\n        role: 'value.power',\n        unit: 'W',\n    },\n};\n\nclass Shrdzm extends utils.Adapter {\n    private udp4Srv: dgram.Socket | null = null;\n    private udp4SrvRetry = 10;\n\n    public constructor(options: Partial<utils.AdapterOptions> = {}) {\n        super({\n            ...options,\n            name: 'shrdzm',\n        });\n        this.on('ready', this.onReady.bind(this));\n        this.on('unload', this.onUnload.bind(this));\n    }\n\n    /**\n     * onReady\n     *\n     * Is called when databases are connected and adapter received configuration.\n     */\n    private async onReady(): Promise<void> {\n        this.log.silly(`onReady()`);\n\n        await this.setState('info.connection', false, true);\n\n        await utils.I18n.init(`${__dirname}/..`, this);\n\n        if (!this.validateConfig()) {\n            this.disable;\n            return;\n        }\n\n        if (!this.initUdp4Srv()) {\n            this.disable;\n            return;\n        }\n    }\n\n    /**\n     * onUnload\n     *\n     * Is called when adapter shuts down - callback has to be called under any circumstances!\n     *\n     * @param callback standard ioBroker callback\n     */\n    private onUnload(callback: () => void): void {\n        try {\n            this.udp4Srv && this.udp4Srv.close();\n\n            callback();\n        } catch {\n            callback();\n        }\n    }\n\n    /**\n     * processUdp4Message\n     *\n     * handles a message received via udp4Srv\n     *\n     * @param msg data pacakte received (should be json)\n     * @param rinfo remote infor record\n     */\n    private async processUdp4Message(msg: Buffer, rinfo: RemoteInfo): Promise<void> {\n        this.log.silly(`processUdp4SrvMessage(${msg.toString()}, ${JSON.stringify(rinfo)})`);\n\n        let msgJson: ShrdzmMsg;\n\n        try {\n            msgJson = await JSON.parse(msg.toString());\n        } catch (e: any) {\n            this.log.warn(`invalid packet received - ${e.message}`);\n            this.log.warn(`${msg.toString()}`);\n            return;\n        }\n\n        if (!msgJson.id) {\n            this.log.warn('invalid packet received - id is missing');\n            this.log.warn(`${msg.toString()}`);\n            return;\n        }\n\n        const data = msgJson.data;\n        if (!data) {\n            this.log.warn('invalid packet received - data is missing');\n            this.log.warn(`${msg.toString()}`);\n            return;\n        }\n\n        if (!(await this.validateDevice(msgJson.id))) {\n            this.log.debug(`ignoreing message from device ${msgJson.id} due to filter setting`);\n            return;\n        }\n\n        //const ts = Date.parse(data.timestamp);\n\n        for (const obisCode in msgJson.data) {\n            if (!obisCode.match(/\\d+\\.\\d+\\.\\d+/)) {\n                continue;\n            }\n\n            await this.validateObis(msgJson.id, obisCode);\n\n            const value = Number(msgJson.data[obisCode]);\n            await this.setObis(msgJson.id, obisCode, value);\n        }\n    }\n\n    /**\n     * validateConfig\n     *\n     * validates the user supplied configuration\n     */\n    private validateConfig(): boolean {\n        this.log.silly(`validateConfig()`);\n\n        let ok = true;\n        if (!this.config.port || this.config.port < 1024 || this.config.port > 65536) {\n            this.log.error(`invalid udp port ${this.config.port} specified, must be between 1025 and 65535`);\n            ok = false;\n        }\n\n        return ok;\n    }\n\n    /**\n     * initDevice\n     *\n     * initializes the devoce database and creates states if required\n     *\n     * @param id shrzdm device id\n     */\n    private async initDevice(id: ShrzmDeviceId): Promise<void> {\n        this.log.silly(`initDevice( ${id} )`);\n\n        await this.extendObject(\n            `${id}`,\n            {\n                type: 'device',\n                common: {\n                    name: id,\n                },\n                native: {},\n            },\n            { preserve: { common: ['name'] } },\n        );\n\n        // info channel\n        await this.extendObject(\n            `${id}.info`,\n            {\n                type: 'channel',\n                common: {\n                    name: utils.I18n.getTranslatedObject(`lblInfo`),\n                },\n                native: {},\n            },\n            { preserve: { common: ['name'] } },\n        );\n\n        await this.extendObject(\n            `${id}.info.online`,\n            {\n                type: 'state',\n                common: {\n                    name: utils.I18n.getTranslatedObject(`lblInfoOnline`),\n                    type: 'boolean',\n                    role: 'indicator.reachable',\n                    read: true,\n                    write: false,\n                },\n                native: {},\n            },\n            { preserve: { common: ['name'] } },\n        );\n\n        await this.extendObject(\n            `${id}.info.timestamp`,\n            {\n                type: 'state',\n                common: {\n                    name: utils.I18n.getTranslatedObject(`lblInfoTimestamp`),\n                    type: 'number',\n                    role: 'date',\n                    read: true,\n                    write: false,\n                },\n                native: {},\n            },\n            { preserve: { common: ['name'] } },\n        );\n\n        await this.extendObject(\n            `${id}.info.uptime`,\n            {\n                type: 'state',\n                common: {\n                    name: `lblInfoUptime`,\n                    type: 'string',\n                    role: 'value',\n                    read: true,\n                    write: false,\n                },\n                native: {},\n            },\n            { preserve: { common: ['name'] } },\n        );\n\n        // live channel\n        await this.extendObject(\n            `${id}.live`,\n            {\n                type: 'channel',\n                common: {\n                    name: `lblLive`,\n                },\n                native: {},\n            },\n            { preserve: { common: ['name'] } },\n        );\n    }\n\n    /**\n     * initObisState\n     *\n     * initializes OBIS related states\n     *\n     * @param id shrzdm device id\n     * @param obis OBIS code\n     */\n    private async initObisState(id: ShrzmDeviceId, obis: ObisCode): Promise<void> {\n        this.log.silly(`initObisState(${id}, ${obis})`);\n\n        const obisId = obis.replaceAll('.', '_');\n\n        if (OBIS[obis]) {\n            await this.extendObject(\n                `${id}.live.${obisId}`,\n                {\n                    type: 'state',\n                    common: {\n                        name: utils.I18n.getTranslatedObject(OBIS[obis].name),\n                        type: 'number',\n                        role: OBIS[obis].role,\n                        unit: OBIS[obis].unit,\n                    },\n                    native: {},\n                },\n                { preserve: { common: ['name'] } },\n            );\n        } else {\n            await this.extendObject(\n                `${id}.live.${obisId}`,\n                {\n                    type: 'state',\n                    common: {\n                        name: `OBIS-${obisId}`,\n                        type: 'number',\n                        role: 'value',\n                        unit: '',\n                    },\n                    native: {},\n                },\n                { preserve: { common: ['name'] } },\n            );\n        }\n    }\n\n    /**\n     * validateObis\n     *\n     * validate obis code received\n     *\n     * @param id shrzdm device id\n     * @param obis OBIS code\n     */\n    private obisIds: {\n        [key: ObisCode]: boolean;\n    } = {};\n\n    private async validateObis(id: ShrzmDeviceId, obisCode: ObisCode): Promise<void> {\n        this.log.silly(`validateObis(${id}, ${obisCode})`);\n\n        if (this.obisIds[`${id}-${obisCode}`]) {\n            return;\n        }\n\n        await this.initObisState(id, obisCode);\n        this.obisIds[`${id}-${obisCode}`] = true;\n    }\n\n    /**\n     * setObis\n     *\n     * sets state identified by obis code\n     *\n     * @param id shrzdm device id\n     * @param obis OBIS code\n     * @param val value to be set\n     */\n\n    private async setObis(id: ShrzmDeviceId, obisCode: ObisCode, value: number): Promise<void> {\n        this.log.silly(`setObis(${id}, ${obisCode}, ${value})`);\n\n        const obisId = obisCode.replaceAll('.', '_');\n        await this.setState(`${id}.live.${obisId}`, value, true);\n    }\n\n    /**\n     *\n     * validateDevice\n     *\n     * validates whether device should be processed\n     */\n    private deviceIds: {\n        [key: ShrzmDeviceId]: boolean;\n    } = {};\n\n    private async validateDevice(id: ShrzmDeviceId): Promise<boolean> {\n        this.log.silly(`validateDevice(${id})`);\n\n        if (this.deviceIds[id] !== undefined) {\n            return this.deviceIds[id];\n        }\n\n        if (!id.match(/^[A-Z0-9]{12}$/)) {\n            this.log.warn(`message with invalid device id ${id} received, id will be ignored`);\n            this.deviceIds[id] = false;\n        }\n\n        if (this.config.devices && !this.config.devices.includes(id)) {\n            this.log.warn(`message from device with id ${id} received, id will be ignored`);\n            this.deviceIds[id] = false;\n        }\n\n        this.log.info(`device ${id} is active`);\n        await this.initDevice(id);\n        this.deviceIds[id] = true;\n\n        return true;\n    }\n\n    /**\n     * initUdp4Srv\n     *\n     * initializes the udp4Srv instance\n     */\n    private initUdp4Srv(): boolean {\n        try {\n            this.udp4Srv = dgram.createSocket('udp4');\n            this.udp4Srv.on('error', this.onUdp4SrvError.bind(this));\n            this.udp4Srv.on('message', this.onUdp4SrvMessage.bind(this));\n            this.udp4Srv.on('listening', this.onUdp4SrvListening.bind(this));\n        } catch (e: any) {\n            console.log(`error initializing udp4Src - ${e.message}`);\n            return false;\n        }\n\n        try {\n            this.udp4Srv && this.udp4Srv.bind(this.config.port);\n        } catch (e: any) {\n            console.log(`error binding udp4Src to port ${this.config.port} - ${e.message}`);\n            return false;\n        }\n        return true;\n    }\n\n    /**\n     * onUdp4SrvError\n     *\n     * is called if any error occures at udp4Srv socket\n     *\n     * @param err standard error object\n     */\n    private async onUdp4SrvError(err: Error): Promise<void> {\n        this.log.silly(`onUdp4SrvError( err )`);\n\n        this.log.error(`error reported by udp4Srv:\\n${err.stack}`);\n        this.udp4Srv && this.udp4Srv.close();\n\n        await this.setState('info.connection', false, true);\n\n        if (this.udp4SrvRetry--) {\n            this.log.info(`trying to restablish udp connection in 5s`);\n            this.setTimeout(this.initUdp4Srv, 5 * 1000);\n        } else {\n            this.log.error(`maximum number of retries exceeded`);\n        }\n    }\n\n    /**\n     * onUdp4SrvMessage\n     *\n     * is called whenever a new message is received at udp4Srv socket\n     *\n     * @param msg shrdzm data block received\n     * @param rinfo remote information provided by dram service\n     */\n    private async onUdp4SrvMessage(msg: Buffer, rinfo: RemoteInfo): Promise<void> {\n        this.log.debug(`onUdp4SrvMessage(${msg.toString()}, ${rinfo.address}:${rinfo.port})`);\n\n        await this.processUdp4Message(msg, rinfo);\n    }\n\n    /**\n     * onUdpSrvListening\n     *\n     * is cllaed as soon as server starts listening\n     */\n    private async onUdp4SrvListening(): Promise<void> {\n        if (this.udp4Srv) {\n            const address = this.udp4Srv.address();\n            this.log.info(`server listening ${address.address}:${address.port}`);\n\n            this.udp4SrvRetry = 12 * 60; // app. 1h of retries\n\n            await this.setState('info.connection', true, true);\n        }\n    }\n}\n\nif (require.main !== module) {\n    // Export the constructor in compact mode\n    module.exports = (options: Partial<utils.AdapterOptions> | undefined) => new Shrdzm(options);\n} else {\n    // otherwise start the instance directly\n    (() => new Shrdzm())();\n}\n"],
  "mappings": "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",
  "names": ["dgram"]
}
